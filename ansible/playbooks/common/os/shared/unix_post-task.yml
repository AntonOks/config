---
# FNM Versions
- name: "List installed fnm versions"
  command: fnm ls
  register: fnmv_list
  changed_when: false
  check_mode: false
  tags:
    - install-fnm-version

- name: Installing fnm version
  shell: "fnm install {{ item }}"
  loop: "{{ fnm_versions }}"
  register: install_fnm_version
  until: install_fnm_version is successful
  when:
    - fnm_versions is defined
    - item not in fnmv_list.stdout
  tags:
    - install-fnm-version

# NPM Modules
- name: "List installed npm modules"
  command: npm list -g --depth=0
  register: npm_modules_installed
  changed_when: false
  check_mode: false
  tags:
    - install-fnm-version
- name: Installing npm modules
  npm:
    global: yes
    path: "{{ HOME }}/.npm-global"
    name: "{{ item }}"
    state: present
  loop: "{{ npm_modules }}"
  register: install_npm_package
  until: install_npm_package is successful
  when:
    - npm_modules is defined
    - item not in npm_modules_installed.stdout
  tags:
    - install-npm-modules

# PIP Modules
- name: Installing pip modules
  pip:
    name: "{{ item }}"
    state: present
    executable: pip3
  loop: "{{ pip_modules }}"
  register: install_pip_module
  until: install_pip_module is successful
  when: pip_modules is defined
  tags:
    - install-pip-modules

# Post-installation
# GIT Config
- name: Set GIT e-mail
  git_config:
    name: user.email
    scope: global
    value: "dalisoft@mail.ru"
- name: Set GIT username
  git_config:
    name: user.name
    scope: global
    value: "dalisoft"
